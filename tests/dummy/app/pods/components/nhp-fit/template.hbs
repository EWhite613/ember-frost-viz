<!-- Chart element. -->
{{#frost-viz/chart data
  as |chart|}}

  {{#frost-viz/scope chart
    (hash
      dimensions=(hash
        x=(frost-viz/dimension/time chart)
        y=(frost-viz/dimension/linear chart)
    ))
    as |scope|}}

    {{#frost-viz/transform/cartesian scope
      dataBindings=(hash
        x=(frost-viz/binding scope.dimensions.x 'time')
        y=(array
          (frost-viz/binding scope.dimensions.y 'min')
          (frost-viz/binding scope.dimensions.y 'center')
          (frost-viz/binding scope.dimensions.y 'max')
          (frost-viz/binding scope.dimensions.y 'critical')
          (frost-viz/binding scope.dimensions.y 'value')
        )
      )
      as |transform dataBindings|
    }}

      {{frost-viz/scale transform dataBindings.x label='Date' align='bottom' ticks=10 tickLabelFormat=(frost-viz/format/time '%Y-%m-%d %H:%M')}}
      {{frost-viz/scale transform dataBindings.y.[0] label='PM Measured Value' align='left' ticks=10 tickLabelFormat=(frost-viz/format/numeric)}}

      <!-- Min line -->
      {{#frost-viz/plot/line transform
        dataBindings=(hash
          x=dataBindings.x
          y=dataBindings.y.[0]
        )
        as |begin end data|
      }}
        {{#if (eq begin.element.source 'observed')}}
          {{frost-viz/plot/element/line-segment begin end stroke-dasharray="5, 5"}}
        {{else}}
          {{frost-viz/plot/element/line-segment begin end stroke-dasharray="2, 8"}}
        {{/if}}
      {{/frost-viz/plot/line}}

      <!-- Center line -->
      {{#frost-viz/plot/line transform
        dataBindings=(hash y=dataBindings.y.[1])
        as |begin end data|
      }}
        {{#if (eq begin.element.source 'projected')}}
          {{frost-viz/plot/element/line-segment begin end stroke-dasharray="5, 5"}}
        {{else}}
          {{frost-viz/plot/element/line-segment begin end}}
        {{/if}}
      {{/frost-viz/plot/line}}

      <!-- Max line -->
      {{#frost-viz/plot/line transform
        dataBindings=(hash y=dataBindings.y.[2])
        as |begin end data|
      }}
        {{#if (eq begin.element.source 'observed')}}
          {{frost-viz/plot/element/line-segment begin end stroke-dasharray="5, 5"}}
        {{else}}
          {{frost-viz/plot/element/line-segment begin end stroke-dasharray="2, 8"}}
        {{/if}}
      {{/frost-viz/plot/line}}

      <!-- Critical line -->
      {{#frost-viz/plot/line transform
        dataBindings=(hash y=dataBindings.y.[3])
        as |begin end data|
      }}
        {{frost-viz/plot/element/line-segment begin end stroke-dasharray="2, 2"}}
      {{/frost-viz/plot/line}}

      <!-- Raw observations and critical value intercept -->
      {{#frost-viz/plot/scatter transform
        dataBindings=(hash y=dataBindings.y.[4])
        as |item data|
      }}
        {{#if item.element.value}}
          {{#if (eq item.element.source 'observed')}}
            {{frost-viz/plot/element/symbol/circle item data r=2 fill='cyan'}}
          {{else}}
            <defs>
              <marker id='head' orient='auto' markerWidth='2' markerHeight='4' refX='0.1' refY='2'>
                <path d='M0,0 V4 L2,2 Z' fill='black' />
              </marker>
            </defs>
            <path
              marker-end='url(#head)'
              stroke-width='2' fill='none' stroke='black'
              d="M{{item.x}},{{item.y}} m0,24 l0,-20"
            />
          {{/if}}
        {{/if}}
      {{/frost-viz/plot/scatter}}

    {{/frost-viz/transform/cartesian}}

  {{/frost-viz/scope}}

{{/frost-viz/chart}}
